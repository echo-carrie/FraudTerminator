# pip install zhipuai è¯·å…ˆåœ¨ç»ˆç«¯è¿›è¡Œå®‰è£…

from zhipuai import ZhipuAI

# è¿™æ˜¯å®‡èˆªçš„API Keyï¼ŒèŠ‚çœä¸€ç‚¹ä½¿ç”¨ ğŸ¥ºğŸ¥ºğŸ¥ºğŸ¥ºğŸ¥ºğŸ¥º
client = ZhipuAI(api_key="a0166a5c17216218cf0ac15889dfe327.uu0rgI10O9HWD0jM")

response = client.chat.completions.create(
    model="glm-4-flash",
    messages=[
        {
            "role": "system",
            "content": "ä½ æ˜¯ä¸€ä¸ªä¹äºè§£ç­”å„ç§é—®é¢˜çš„åŠ©æ‰‹ï¼Œä½ çš„ä»»åŠ¡æ˜¯ä¸ºç”¨æˆ·æä¾›ä¸“ä¸šã€å‡†ç¡®ã€æœ‰è§åœ°çš„å»ºè®®ã€‚"
        },
        {
            "role": "user",
            "content": """Role: SQLè½¬æ¢å™¨
Goals: å‡†ç¡®ç†è§£ç”¨æˆ·çš„æ—¥å¸¸è¯­è¨€æè¿°ï¼Œå¹¶è½¬æ¢æˆæœ‰æ•ˆçš„SQLæŸ¥è¯¢è¯­å¥
Constrains: ä¿æŒç”¨æˆ·åŸæœ‰æè¿°çš„æ„å›¾å’Œç›®æ ‡ï¼Œç¡®ä¿SQLæŸ¥è¯¢è¯­å¥çš„å‡†ç¡®æ€§å’Œå¯æ‰§è¡Œæ€§
Skills: ç²¾é€šSQLè¯­è¨€ï¼Œç†è§£å¹¶è§£æç”¨æˆ·çš„æ—¥å¸¸è¯­è¨€æè¿°ï¼Œæä¾›é«˜æ•ˆçš„è½¬æ¢å»ºè®®
Outputformat: ä»¥SQLæŸ¥è¯¢è¯­å¥çš„å½¢å¼è¾“å‡ºï¼Œç¡®ä¿è¯­å¥çš„å‡†ç¡®æ€§å’Œå¯æ‰§è¡Œæ€§
Workflow: 1. è¯»å–å¹¶ç†è§£ç”¨æˆ·çš„æ—¥å¸¸è¯­è¨€æè¿°ï¼›2. æ ¹æ®æè¿°å†…å®¹ï¼Œè½¬æ¢æˆå¯¹åº”çš„SQLæŸ¥è¯¢è¯­å¥ï¼›3. ç¡®ä¿SQLæŸ¥è¯¢è¯­å¥çš„å‡†ç¡®æ€§å’Œå¯æ‰§è¡Œæ€§ï¼›4. è¾“å‡ºä¼˜åŒ–åçš„SQLæŸ¥è¯¢è¯­å¥ã€‚
Initialization: è¯·" ä¸€ä¸ªâ€œå‘˜å·¥â€çš„è¡¨æ ¼ï¼Œå®ƒåŒ…å«å‘˜å·¥çš„IDã€å§“åã€èŒä½å’Œè–ªæ°´ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦æ‰¾å‡ºæ‰€æœ‰æ‹…ä»»â€œç»ç†â€èŒä½çš„å‘˜å·¥çš„å§“åå’Œè–ªæ°´ï¼Œå¹¶æŒ‰ç…§è–ªæ°´ä»é«˜åˆ°ä½æ’åºã€‚"è½¬æ¢ä¸ºSQLæŸ¥è¯¢è¯­å¥
"""
        }
    ],
    top_p=0.7,
    temperature=0.95,
    max_tokens=1024,
    tools=[{"type": "web_search", "web_search": {"search_result": True}}],
    stream=True,
)
for trunk in response:
    print(trunk.choices[0].delta.content, end="")
